<!-- ëŒ“ê¸€ ì•„ì´í…œ í…œí”Œë¦¿ -->
<div class="comment-item comment-depth-{{depth}}">
    <div class="comment-header">
        <div>
            <span class="comment-author">{{authorId}}</span>
            {{#depth}}
            <span class="comment-depth-badge">{{depth}}ë‹¨ê³„</span>
            {{/depth}}
        </div>
        <span class="comment-date">{{createdAt}}</span>
    </div>
    
    {{#deleted}}
    <div class="comment-content deleted-comment">
        ğŸ—‘ï¸ ì‚­ì œëœ ëŒ“ê¸€ì…ë‹ˆë‹¤
    </div>
    {{/deleted}}
    {{^deleted}}
    <div class="comment-content">{{content}}</div>
    
    <!-- ë‹µê¸€ ì‘ì„± ë²„íŠ¼ (ìµœëŒ€ ê¹Šì´ 5ê¹Œì§€) -->
    {{#canReply}}
    <div class="comment-actions">
        <button class="btn-reply" onclick="toggleReplyForm({{id}})">â†©ï¸ ë‹µê¸€</button>
    </div>
    
    <!-- ë‹µê¸€ ì‘ì„± í¼ (ìˆ¨ê¹€ ìƒíƒœ) -->
    <div id="reply-form-{{id}}" class="reply-form" style="display: none;">
        <form action="/posts/{{postId}}/comments/{{id}}/reply" method="post">
            <div class="form-group">
                <label for="reply-author-{{id}}">ë‹‰ë„¤ì„</label>
                <input type="text" id="reply-author-{{id}}" name="authorId" required 
                       placeholder="ìµëª…ì˜ ë‹µê¸€ëŸ¬" maxlength="50">
            </div>
            <div class="form-group">
                <label for="reply-content-{{id}}">ë‹µê¸€ ë‚´ìš©</label>
                <textarea id="reply-content-{{id}}" name="content" required 
                          placeholder="{{authorId}}ë‹˜ì—ê²Œ ë‹µê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”..." 
                          maxlength="1000" rows="3"></textarea>
            </div>
            <div class="reply-actions">
                <button type="submit" class="btn-reply-submit">ğŸ’¬ ë‹µê¸€ ë‹¬ê¸°</button>
                <button type="button" class="btn-cancel" onclick="toggleReplyForm({{id}})">ì·¨ì†Œ</button>
            </div>
        </form>
    </div>
    {{/canReply}}
    {{/deleted}}
</div>

<!-- ìì‹ ëŒ“ê¸€ë“¤ì„ ì¬ê·€ì ìœ¼ë¡œ í‘œì‹œ -->
{{#children}}
{{>comment_item}}
{{/children}}

<style>
.comment-depth-badge {
    background: #ff6b6b;
    color: white;
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 0.7em;
    margin-left: 5px;
}

.deleted-comment {
    color: #999;
    font-style: italic;
}

.comment-actions {
    margin-top: 10px;
}

.btn-reply {
    background: #e9ecef;
    color: #495057;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.8em;
    cursor: pointer;
    transition: background-color 0.3s;
}

.btn-reply:hover {
    background: #dee2e6;
}

.reply-form {
    margin-top: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 6px;
    border-left: 3px solid #ff6b6b;
}

.reply-form .form-group {
    margin-bottom: 10px;
}

.reply-form label {
    display: block;
    margin-bottom: 3px;
    font-size: 0.9em;
    font-weight: bold;
    color: #333;
}

.reply-form input[type="text"],
.reply-form textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 0.9em;
    box-sizing: border-box;
}

.reply-actions {
    margin-top: 10px;
}

.btn-reply-submit {
    background-color: #ff6b6b;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    font-size: 0.8em;
    cursor: pointer;
    margin-right: 5px;
}

.btn-cancel {
    background-color: #6c757d;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    font-size: 0.8em;
    cursor: pointer;
}

.btn-reply-submit:hover {
    background-color: #ff5252;
}

.btn-cancel:hover {
    background-color: #5a6268;
}
</style>

<script>
function toggleReplyForm(commentId) {
    const replyForm = document.getElementById('reply-form-' + commentId);
    if (replyForm.style.display === 'none' || replyForm.style.display === '') {
        replyForm.style.display = 'block';
    } else {
        replyForm.style.display = 'none';
    }
}
</script>